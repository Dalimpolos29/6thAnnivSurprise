<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#ec4899">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <title>Home - Den & Anna</title>

  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <link rel="manifest" href="manifest.json">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap" rel="stylesheet">

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/animations.css">

  <style>
    /* Home Page Specific Styles */
    .home-page {
      min-height: 100vh;
      min-height: 100dvh;
      padding-bottom: calc(var(--bottom-nav-height) + var(--space-4));
    }

    /* Header */
    .home-header {
      padding: var(--space-6) var(--space-4);
      padding-top: calc(var(--space-6) + var(--safe-area-top));
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .greeting {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .greeting-avatar {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-full);
      object-fit: cover;
      border: 2px solid var(--primary-200);
    }

    .greeting-text h2 {
      font-family: var(--font-display);
      font-size: var(--text-lg);
      margin-bottom: 2px;
    }

    .greeting-text p {
      font-size: var(--text-sm);
      color: var(--text-muted);
    }

    .header-actions {
      display: flex;
      gap: var(--space-2);
    }

    /* Hero Section */
    .hero-section {
      text-align: center;
      padding: var(--space-6) var(--space-4);
      position: relative;
    }

    .couple-images {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: var(--space-6);
      position: relative;
    }

    .couple-image {
      width: 100px;
      height: 100px;
      border-radius: var(--radius-full);
      object-fit: cover;
      border: 4px solid var(--surface);
      box-shadow: var(--shadow-xl);
      position: relative;
      z-index: 1;
    }

    .couple-image:first-child {
      transform: translateX(15px);
    }

    .couple-image:last-child {
      transform: translateX(-15px);
    }

    .couple-heart {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      box-shadow: var(--shadow-lg);
      animation: heartbeat 1.5s ease-in-out infinite;
    }

    .hero-title {
      font-family: var(--font-display);
      font-size: var(--text-3xl);
      margin-bottom: var(--space-2);
      background: linear-gradient(135deg, var(--primary-600), var(--primary-400));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-subtitle {
      font-family: var(--font-display);
      font-style: italic;
      color: var(--text-secondary);
      font-size: var(--text-lg);
    }

    /* Anniversary Counter */
    .counter-section {
      padding: var(--space-4);
    }

    .counter-card {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-lg), var(--shadow-glow);
      text-align: center;
    }

    .counter-label {
      font-family: var(--font-display);
      font-size: var(--text-lg);
      color: var(--text-secondary);
      margin-bottom: var(--space-4);
    }

    .counter-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--space-3);
      margin-bottom: var(--space-6);
    }

    .counter-item {
      background: linear-gradient(135deg, var(--primary-50), var(--background));
      padding: var(--space-4) var(--space-2);
      border-radius: var(--radius-xl);
      border: 1px solid var(--primary-100);
    }

    .counter-value {
      font-family: var(--font-display);
      font-size: var(--text-3xl);
      font-weight: 700;
      color: var(--primary-600);
      line-height: 1;
      display: block;
    }

    .counter-unit {
      font-size: var(--text-xs);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: var(--space-1);
      display: block;
    }

    .counter-total {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
      padding: var(--space-3);
      background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
      border-radius: var(--radius-xl);
      color: white;
    }

    .counter-total-value {
      font-family: var(--font-display);
      font-size: var(--text-2xl);
      font-weight: 700;
    }

    .counter-total-label {
      font-size: var(--text-sm);
      opacity: 0.9;
    }

    /* Quick Actions */
    .actions-section {
      padding: var(--space-4);
    }

    .actions-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-4);
    }

    .action-card {
      background: var(--surface);
      border-radius: var(--radius-xl);
      padding: var(--space-5);
      box-shadow: var(--shadow-md);
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-3);
      transition: all var(--transition-base);
      border: 1px solid var(--border-light);
    }

    .action-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-xl);
      border-color: var(--primary-200);
    }

    .action-card:active {
      transform: translateY(-2px);
    }

    .action-icon {
      width: 56px;
      height: 56px;
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.75rem;
    }

    .action-icon.chat {
      background: linear-gradient(135deg, #ec4899, #db2777);
    }

    .action-icon.gallery {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .action-title {
      font-weight: 600;
      font-size: var(--text-base);
    }

    .action-desc {
      font-size: var(--text-sm);
      color: var(--text-muted);
      text-align: center;
    }

    /* Recent Memories */
    .memories-section {
      padding: var(--space-4);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-4);
    }

    .section-title {
      font-family: var(--font-display);
      font-size: var(--text-xl);
    }

    .see-all {
      font-size: var(--text-sm);
      color: var(--primary-500);
      text-decoration: none;
      font-weight: 500;
    }

    .memories-scroll {
      display: flex;
      gap: var(--space-3);
      overflow-x: auto;
      padding-bottom: var(--space-2);
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }

    .memories-scroll::-webkit-scrollbar {
      display: none;
    }

    .memory-card {
      flex: 0 0 140px;
      scroll-snap-align: start;
    }

    .memory-card img {
      width: 140px;
      height: 180px;
      object-fit: cover;
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-md);
      transition: transform var(--transition-base);
    }

    .memory-card:hover img {
      transform: scale(1.03);
    }

    /* Floating Hearts */
    .particles-container {
      pointer-events: none;
    }

    /* Responsive */
    @media (min-width: 480px) {
      .hero-title {
        font-size: var(--text-4xl);
      }

      .couple-image {
        width: 120px;
        height: 120px;
      }

      .counter-value {
        font-size: var(--text-4xl);
      }
    }
  </style>
</head>
<body>
  <!-- Background -->
  <div class="mesh-gradient"></div>

  <!-- Floating Hearts -->
  <div class="particles-container" id="particles"></div>

  <!-- Home Page -->
  <div class="home-page">

    <!-- Header -->
    <header class="home-header">
      <div class="greeting">
        <img src="" alt="Avatar" class="greeting-avatar" id="userAvatar">
        <div class="greeting-text">
          <h2 id="greetingName">Hello, Dennis</h2>
          <p id="greetingTime">Good morning</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn btn-icon btn-ghost" onclick="toggleTheme()" title="Toggle theme">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <button class="btn btn-icon btn-ghost" onclick="logoutUser()" title="Logout">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
      <div class="couple-images">
        <img src="photos/Image1.jpg" alt="Dennis" class="couple-image">
        <div class="couple-heart">‚ù§Ô∏è</div>
        <img src="photos/Image2.jpg" alt="Anna" class="couple-image">
      </div>
      <h1 class="hero-title">Den & Anna</h1>
      <p class="hero-subtitle">Forever & Always</p>
    </section>

    <!-- Anniversary Counter -->
    <section class="counter-section">
      <div class="counter-card">
        <p class="counter-label">Together for</p>
        <div class="counter-grid">
          <div class="counter-item">
            <span class="counter-value" id="counter-years">0</span>
            <span class="counter-unit">Years</span>
          </div>
          <div class="counter-item">
            <span class="counter-value" id="counter-months">0</span>
            <span class="counter-unit">Months</span>
          </div>
          <div class="counter-item">
            <span class="counter-value" id="counter-days">0</span>
            <span class="counter-unit">Days</span>
          </div>
          <div class="counter-item">
            <span class="counter-value" id="counter-hours">0</span>
            <span class="counter-unit">Hours</span>
          </div>
        </div>
        <div class="counter-total">
          <span class="counter-total-value" id="counter-total-days">0</span>
          <span class="counter-total-label">days of love</span>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="actions-section">
      <div class="actions-grid">
        <a href="chat.html" class="action-card">
          <div class="action-icon chat">üí¨</div>
          <span class="action-title">Chat</span>
          <span class="action-desc">Send a message</span>
        </a>
        <a href="gallery.html" class="action-card">
          <div class="action-icon gallery">üì∏</div>
          <span class="action-title">Gallery</span>
          <span class="action-desc">View memories</span>
        </a>
      </div>
    </section>

    <!-- Recent Memories -->
    <section class="memories-section">
      <div class="section-header">
        <h3 class="section-title">Recent Memories</h3>
        <a href="gallery.html" class="see-all">See all</a>
      </div>
      <div class="memories-scroll" id="memoriesScroll"></div>
    </section>

  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="home.html" class="nav-item active">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
        <polyline points="9 22 9 12 15 12 15 22"/>
      </svg>
      <span>Home</span>
    </a>
    <a href="chat.html" class="nav-item">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
      </svg>
      <span>Chat</span>
    </a>
    <a href="gallery.html" class="nav-item">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
        <circle cx="8.5" cy="8.5" r="1.5"/>
        <polyline points="21 15 16 10 5 21"/>
      </svg>
      <span>Gallery</span>
    </a>
  </nav>

  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/supabase.js"></script>
  <script src="js/app.js"></script>

  <script>
    // Initialize Home Page
    function initHomePage() {
      // Check authentication
      if (!isLoggedIn()) {
        window.location.href = 'index.html';
        return;
      }

      // Setup user info
      setupUserInfo();

      // Setup anniversary counter
      setupCounter();

      // Load recent memories
      loadRecentMemories();

      // Generate floating hearts
      generateFloatingHearts();

      // Animate entrance
      animateEntrance();
    }

    function setupUserInfo() {
      const user = getCurrentUser();
      if (!user) return;

      // Set avatar
      document.getElementById('userAvatar').src = user.avatar;

      // Set greeting
      const hour = new Date().getHours();
      let timeGreeting = 'Good evening';
      if (hour < 12) timeGreeting = 'Good morning';
      else if (hour < 18) timeGreeting = 'Good afternoon';

      document.getElementById('greetingName').textContent = `Hello, ${user.name}`;
      document.getElementById('greetingTime').textContent = timeGreeting;
    }

    function setupCounter() {
      updateCounterDisplay();
      // Update every second for live counter
      setInterval(updateCounterDisplay, 1000);
    }

    function updateCounterDisplay() {
      const time = calculateTimeTogether();

      // Calculate hours for current day
      const now = new Date();
      const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const hoursSinceMidnight = Math.floor((now - todayStart) / (1000 * 60 * 60));

      // Update values with animation
      updateCounterValue('counter-years', time.years);
      updateCounterValue('counter-months', time.months);
      updateCounterValue('counter-days', time.days);
      updateCounterValue('counter-hours', hoursSinceMidnight);
      updateCounterValue('counter-total-days', time.totalDays.toLocaleString());
    }

    function updateCounterValue(elementId, newValue) {
      const element = document.getElementById(elementId);
      if (!element) return;

      const currentValue = element.textContent;
      if (currentValue !== String(newValue)) {
        element.textContent = newValue;

        // Add pop animation
        gsap.fromTo(element,
          { scale: 1.2 },
          { scale: 1, duration: 0.3, ease: 'back.out(1.7)' }
        );
      }
    }

    function loadRecentMemories() {
      const container = document.getElementById('memoriesScroll');
      const shuffled = [...PHOTOS].sort(() => Math.random() - 0.5);
      const recentPhotos = shuffled.slice(0, 10);

      recentPhotos.forEach((photo, index) => {
        const card = document.createElement('div');
        card.className = 'memory-card';
        card.innerHTML = `<img src="photos/${photo}" alt="Memory ${index + 1}" loading="lazy">`;

        card.addEventListener('click', () => {
          window.location.href = 'gallery.html';
        });

        container.appendChild(card);
      });
    }

    function generateFloatingHearts() {
      const container = document.getElementById('particles');
      const hearts = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì', '‚ú®'];

      for (let i = 0; i < 12; i++) {
        const heart = document.createElement('span');
        heart.className = 'particle';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = `${Math.random() * 100}%`;
        heart.style.animationDelay = `${Math.random() * 15}s`;
        heart.style.animationDuration = `${15 + Math.random() * 10}s`;
        heart.style.fontSize = `${0.6 + Math.random() * 0.8}rem`;
        container.appendChild(heart);
      }
    }

    function animateEntrance() {
      // Animate header
      gsap.from('.home-header', {
        opacity: 0,
        y: -20,
        duration: 0.6,
        ease: 'power2.out'
      });

      // Animate couple images
      gsap.from('.couple-image', {
        scale: 0,
        rotation: -180,
        duration: 0.8,
        ease: 'back.out(1.7)',
        stagger: 0.15,
        delay: 0.2
      });

      // Animate heart
      gsap.from('.couple-heart', {
        scale: 0,
        duration: 0.5,
        ease: 'back.out(2)',
        delay: 0.6
      });

      // Animate hero text
      gsap.from('.hero-title, .hero-subtitle', {
        opacity: 0,
        y: 20,
        duration: 0.6,
        stagger: 0.1,
        ease: 'power2.out',
        delay: 0.4
      });

      // Animate counter card
      gsap.from('.counter-card', {
        opacity: 0,
        y: 30,
        duration: 0.8,
        ease: 'power3.out',
        delay: 0.6
      });

      // Animate counter items
      gsap.from('.counter-item', {
        opacity: 0,
        scale: 0.8,
        duration: 0.5,
        stagger: 0.1,
        ease: 'back.out(1.7)',
        delay: 0.8
      });

      // Animate action cards
      gsap.from('.action-card', {
        opacity: 0,
        y: 20,
        duration: 0.5,
        stagger: 0.15,
        ease: 'power2.out',
        delay: 1
      });

      // Animate memories
      gsap.from('.memory-card', {
        opacity: 0,
        x: 30,
        duration: 0.5,
        stagger: 0.08,
        ease: 'power2.out',
        delay: 1.2
      });

      // Animate bottom nav
      gsap.from('.bottom-nav', {
        opacity: 0,
        y: 20,
        duration: 0.5,
        ease: 'power2.out',
        delay: 1.4
      });
    }

    // Calculate time together function
    function calculateTimeTogether() {
      const now = new Date();
      const anniversary = APP_CONFIG.anniversaryDate;

      let years = now.getFullYear() - anniversary.getFullYear();
      let months = now.getMonth() - anniversary.getMonth();
      let days = now.getDate() - anniversary.getDate();

      if (days < 0) {
        months--;
        const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);
        days += prevMonth.getDate();
      }

      if (months < 0) {
        years--;
        months += 12;
      }

      const totalDays = Math.floor((now - anniversary) / (1000 * 60 * 60 * 24));

      return { years, months, days, totalDays };
    }

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', initHomePage);
  </script>
</body>
</html>
